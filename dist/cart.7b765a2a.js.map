{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,mCCSA,SAASC,EAAeC,GACpB,OAAO,IAAIC,KAAKC,aAAa,QAAS,CAClCC,MAAO,WACPC,SAAU,MACVC,sBAAuB,IACxBC,OAAON,GDRd,MAAMO,EAAcC,SAASC,eAAe,QACtCC,EAAeF,SAASC,eAAe,SAC7C,IACIE,EADAC,EAAO,GAGX,SAASC,EAASC,GACd,IAAIC,EAAQ,EACZD,EAAKE,SAAQC,KA0BjB,SAAuBA,GACnB,MAAMC,EAAcV,SAASW,cAAc,MAC3CD,EAAYE,UAAY,UACxBF,EAAYG,UAAY,2BAmBbJ,EAAOK,OAAO,4FACUL,EAAAM,6CAC1BxB,EAA0BkB,EAAAjB,8IAY3BwB,YAAGN,GAKXA,EAAAO,iBAAA,SAASC,IAER,WAAAA,EAAAC,OAAAC,oCA7DLC,eAA6BC,GACzB,MAAMC,EAAUnB,EAAKoB,QAAOf,GAAWA,EAAQgB,KAAOH,IAEtDlB,EAAOmB,EAEHpB,SACMuB,EAAAC,mBAAmBtC,EAAAuC,GAAIzB,EAAW0B,IAAKN,IC3BrDF,eAAgCf,GAC5BwB,aAAaC,QAAQ,OAAQC,KAAKC,UAAU3B,KD6B5C4B,CAAiBX,GAEjBxB,EAAYc,UAAY,GAExBR,EAASkB,cApBLY,CAAc1B,GACdF,GAAS6B,SAAS3B,EAAQjB,UAG9BU,EAAamC,UAAY9C,EAAegB,0FCd5C,WACI,MAAM+B,EAASR,aAAaS,QAAQ,QACpC,OAAOD,EAASN,KAAKQ,MAAMF,GAAU","sources":["src/scripts/cart.js","src/utils/index.js"],"sourcesContent":["import { auth, db } from \"../scripts/apps\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/functionCart.js\";\r\nimport { addProductToCart } from \"../utils\";\r\nimport { getMyLocalCart, currencyFormat } from \"../utils/index\";\r\n\r\nconst cartSection = document.getElementById(\"cart\");\r\nconst totalSection = document.getElementById(\"total\");\r\nlet cart = [];\r\nlet userLogged;\r\n\r\nfunction loadCart(cart) {\r\n    let total = 0;\r\n    cart.forEach(product => {\r\n        renderProduct(product);\r\n        total += parseInt(product.price);\r\n    });\r\n\r\n    totalSection.innerText = currencyFormat(total);\r\n};\r\n\r\nasync function removeProduct(productId) {\r\n    const newCart = cart.filter(product => product.id !== productId);\r\n    \r\n    cart = newCart;\r\n\r\n    if (userLogged ) {\r\n        await createFirebaseCart(db, userLogged.uid, newCart);\r\n    }\r\n\r\n    addProductToCart(newCart);\r\n\r\n    cartSection.innerHTML = \"\";\r\n\r\n    loadCart(newCart);\r\n\r\n}\r\n\r\n\r\nfunction renderProduct(product) {\r\n    const productCart = document.createElement(\"li\");\r\n    productCart.className = \"product\";\r\n    productCart.innerHTML = `\r\n\r\n    \r\n    <img src=\"${product.images[0]}\" class=\"product__image\"> \r\n    <div class =\"product__info\"> <h3 class=\"product__name\">${product.name}</h3>\r\n    <h3 class=\"product__price\">${currencyFormat(product.price)}</h3>\r\n    <div>  <button class=\"product__delete\">Eliminar producto</button> </div>\r\n     </div>\r\n     \r\n\r\n\r\n    \r\n    \r\n    \r\n    `;\r\n\r\n    cartSection.appendChild(productCart);\r\n\r\n    productCart.addEventListener(\"click\", e => {\r\n         if (e.target.tagName === \"BUTTON\") {\r\n             console.log(\"remove it!\");\r\n             removeProduct(product.id);\r\n         }\r\n    })\r\n};\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n      // User is signed in, see docs for a list of available properties\r\n      // https://firebase.google.com/docs/reference/js/firebase.User\r\n      userLogged = user;\r\n      cart = await getFirebaseCart(db, userLogged.uid);\r\n    } else {\r\n        cart = getMyLocalCart();\r\n      // User is signed out\r\n      // ...\r\n    }\r\n\r\n    loadCart(cart);\r\n\r\n  });\r\n\r\n","async function addProductToCart(cart) {\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n};\r\n\r\nfunction getMyLocalCart() {\r\n    const myCart = localStorage.getItem(\"cart\");\r\n    return myCart ? JSON.parse(myCart) : [];\r\n}\r\n\r\nfunction currencyFormat(price) {\r\n    return new Intl.NumberFormat(\"es-CO\", {\r\n        style: 'currency',\r\n        currency: 'COP',\r\n        minimumFractionDigits: 0\r\n    }).format(price);\r\n}\r\n\r\nexport {\r\n    addProductToCart,\r\n    getMyLocalCart,\r\n    currencyFormat\r\n}"],"names":["$lrymF","parcelRequire","$1eef38cfda4b0c52$export$4670d0ed237a9270","price","Intl","NumberFormat","style","currency","minimumFractionDigits","format","$ff14a25859eedfe9$var$cartSection","document","getElementById","$ff14a25859eedfe9$var$totalSection","$ff14a25859eedfe9$var$userLogged","$ff14a25859eedfe9$var$cart","$ff14a25859eedfe9$var$loadCart","cart","total","forEach","product","productCart","createElement","className","innerHTML","images","name","appendChild","addEventListener","e","target","tagName","async","productId","newCart","filter","id","$bNIB4","createFirebaseCart","db","uid","localStorage","setItem","JSON","stringify","$1eef38cfda4b0c52$export$1bdbccb25be1b1c","$ff14a25859eedfe9$var$renderProduct","parseInt","innerText","myCart","getItem","parse"],"version":3,"file":"cart.7b765a2a.js.map"}