{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,SCAAC,EAAAD,EAAA,oDDMA,MAAME,EAAqBC,SAASC,eAAe,eAC7CC,EAAuBF,SAASC,eAAe,iBAErD,IAAIE,EACAC,EAAO,GAWXC,eAAeC,IACX,MAAMC,EAVV,SAAkBC,GAEd,MAAMC,EAAMC,OAAOC,SAASC,OAG5B,OAFqB,IAAIC,gBAAgBJ,GACVK,IAAIN,GAMjBO,CAAS,OAgB/B,SAAuBC,GAEnBd,EAAqBe,UAAY,yCAAyCD,EAAQE,OAAO,OAEzF,MAEMC,EAFuBf,EAAKgB,MAAMC,GAAgBA,EAAYC,KAAON,EAAQM,KAGnF,mEAAkE,2DAIjEvB,EAAkBkB,UACf,8BAA8BD,EAAQO,oDAWPP,EAAAQ,2aEpDfC,EF+DiCT,EAAAS,ME9D9C,IAAIC,KAAKC,aAAa,QAAS,CAClCC,MAAO,WACPC,SAAU,MACVC,sBAAuB,IACxBC,OAAON,oBF4DbN,IEjED,IAAwBM,EFqExB,MAAAO,EAAAhC,SAAAiC,cAAA,kBACID,EAAUE,iBAAA,SAAAC,IACN/B,EAAAgC,KAAApB,GEhFRX,eAAgCgC,GAC5BC,aAAaC,QAAQ,OAAQC,KAAKC,UAAUJ,IFgFxCK,CAAAtC,GACAD,GAAawC,EAAKC,mBAAA9C,EAAA+C,GAAA1C,EAAA2C,IAAA1C,GAClB4B,EAAAe,aAAO,YAAM,GACbf,EAAYgB,UAAA,sBAlDhBC,CAPgB,UCxBpB5C,eAA0BiB,GAEtB,MAAM4B,EAASC,EAAAC,IAAItD,EAAA+C,GAAI,WAAYvB,GAEnC,IAQI,aAJsB6B,EAAAE,OAAOH,IACRI,OAKxB,MAAMnB,GACHoB,QAAQC,IAAIrB,IDMGsB,CAAWlD,GAK1Be,GAAIf,MA+DRmD,mBAAA5D,EAAA6D,MAAAtD,MAAAuD,IAEDA,+DE1FH,WACI,MAAMC,EAASvB,aAAawB,QAAQ,QACpC,OAAOD,EAASrB,KAAKuB,MAAMF,GAAU","sources":["src/scripts/product.js","src/scripts/functions/getProduct.js","src/utils/index.js"],"sourcesContent":["import { onAuthStateChanged } from \"firebase/auth\";\r\nimport { getProduct } from \"./functions/getProduct\";\r\nimport { auth, db } from \"./apps\";\r\nimport { getMyLocalCart, addProductToCart, currencyFormat } from \"../utils\";\r\nimport { getFirebaseCart, createFirebaseCart } from \"./functions/functionCart\";\r\n\r\nconst productInfoSection = document.getElementById(\"productInfo\");\r\nconst productAssetsSection = document.getElementById(\"productAssets\");\r\n\r\nlet userLogged = undefined;\r\nlet cart = [];\r\n\r\nfunction getParam(param) {\r\n\r\n    const url = window.location.search;\r\n    const searchParams = new URLSearchParams(url);\r\n    const productId = searchParams.get(param);\r\n    return productId;\r\n\r\n}\r\n\r\nasync function loadProduct() {\r\n    const productId = getParam(\"id\");\r\n\r\n    const data = await getProduct(productId);\r\n\r\n    \r\n    const product = {\r\n        ...data,\r\n        id: productId,\r\n\r\n\r\n    }\r\n\r\n    renderProduct(product);\r\n\r\n}\r\n\r\nfunction renderProduct(product) {\r\n\r\n    productAssetsSection.innerHTML = `<img class=\"product__mainImage\" src= \"${product.images[0]}\">`;\r\n\r\n    const isProductAddedToCart = cart.some((productCart) => productCart.id === product.id);\r\n\r\n    const productButtonCart = isProductAddedToCart ?\r\n    '<button class=\"product__cart\" disabled>Producto añadido</button>' :\r\n    '<button class=\"product__cart\">Añadir al carrito</button>';\r\n\r\n\r\n    productInfoSection.innerHTML =\r\n        `<h1 class=\"product__name\"> ${product.name} </h1>\r\n    <p class=\"product__description\"> ${product.description} <br>  <br> Cuando adquieres un de nuestros productos ecológicos, estás apoyando nuestras iniciativas \r\n    para proteger nuestro entorno. El 50% de esta venta, será invertido directamente \r\n    para fines de protección de especies en via de extinción </p>\r\n    <div class=\"price__modif\"> \r\n    <div class=\"price__title\">\r\n     </h1> <h2>Total</h2> \r\n    <p>Envío incluido</p> </div>  <h1 class=\"product__price\"> ${currencyFormat(product.price)}</div> \r\n\r\n    ${productButtonCart}`;\r\n    \r\n    const productCartButton = document.querySelector(\".product__cart\");\r\n    productCartButton.addEventListener(\"click\", e => {\r\n        cart.push(product);\r\n\r\n        addProductToCart(cart);\r\n\r\n        if (userLogged) {\r\n            createFirebaseCart(db, userLogged.uid, cart);\r\n        }\r\n\r\n        productCartButton.setAttribute(\"disabled\", true);\r\n        productCartButton.innerText = \"Producto añadido\";\r\n    });\r\n}\r\n    \r\n\r\n\r\nonAuthStateChanged(auth, async (user) => {\r\n    if (user) {\r\n        // User is signed in, see docs for a list of available properties\r\n        // https://firebase.google.com/docs/reference/js/firebase.User\r\n        userLogged = user;\r\n        cart = await getFirebaseCart(db, userLogged.uid);\r\n        console.log(cart);\r\n        // ...\r\n    } else {\r\n        cart = getMyLocalCart();\r\n        // User is signed out\r\n        // ...\r\n    }\r\n\r\n    loadProduct();\r\n\r\n});","import { db } from \"../apps\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\n\r\nasync function getProduct(id) {\r\n\r\n    const docRef = doc(db, \"products\", id);\r\n\r\n    try {\r\n\r\n\r\n        \r\n        const docSnap = await getDoc(docRef);\r\n        const data = docSnap.data();\r\n\r\n\r\n        return data;\r\n\r\n    }catch(e){\r\n        console.log(e);\r\n    }\r\n}\r\n\r\nexport {\r\n    getProduct\r\n}","async function addProductToCart(cart) {\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n};\r\n\r\nfunction getMyLocalCart() {\r\n    const myCart = localStorage.getItem(\"cart\");\r\n    return myCart ? JSON.parse(myCart) : [];\r\n}\r\n\r\nfunction currencyFormat(price) {\r\n    return new Intl.NumberFormat(\"es-CO\", {\r\n        style: 'currency',\r\n        currency: 'COP',\r\n        minimumFractionDigits: 0\r\n    }).format(price);\r\n}\r\n\r\nexport {\r\n    addProductToCart,\r\n    getMyLocalCart,\r\n    currencyFormat\r\n}"],"names":["$1tHc5","parcelRequire","$lrymF","$63445bb05f51f6f7$var$productInfoSection","document","getElementById","$63445bb05f51f6f7$var$productAssetsSection","$63445bb05f51f6f7$var$userLogged","$63445bb05f51f6f7$var$cart","async","$63445bb05f51f6f7$var$loadProduct","productId","param","url","window","location","search","URLSearchParams","get","$63445bb05f51f6f7$var$getParam","product","innerHTML","images","productButtonCart","some","productCart","id","name","description","price","Intl","NumberFormat","style","currency","minimumFractionDigits","format","productCartButton","querySelector","addEventListener","e","push","cart","localStorage","setItem","JSON","stringify","$1eef38cfda4b0c52$export$1bdbccb25be1b1c","$bNIB4","createFirebaseCart","db","uid","setAttribute","innerText","$63445bb05f51f6f7$var$renderProduct","docRef","$etBjH","doc","getDoc","data","console","log","$96d763eed7c24a29$export$e2005c9600188ac7","onAuthStateChanged","auth","user","myCart","getItem","parse"],"version":3,"file":"product.dbf3116c.js.map"}